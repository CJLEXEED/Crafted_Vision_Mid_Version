<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Art Dashboard - Your Account</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<header>
    <div class="header-container">
        <a href="Home.html" class="logo-container">
            <img src="Crafted Vision_logo.png" alt="Art Dashboard Logo" class="logo">
        </a>

        <div class="nav-icons">
            <a href="shopping.html" class="cart-icon">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count">0</span>
            </a>
            <a href="transaction.html" class="hist-icon">
                <i class="fas fa-history"></i>
            </a>
        </div>

        <h1><i class="fas fa-user-circle"></i> Account</h1>

        <nav>
            <a href="Home.html"><i class="fas fa-home"></i> Home</a>
            <a href="Browse-art.html"><i class="fas fa-paint-brush"></i> Browse Art</a>
            <a href="sell-art.html"><i class="fas fa-store"></i> Sell Art</a>
            <a href="Account.html" class="active"><i class="fas fa-user"></i> Account</a>
            <a href="community.html"><i class="fas fa-users"></i> Community</a>
            <a href="help.html"><i class="fas fa-question-circle"></i> Help</a>
        </nav>
    </div>
</header>

<div class="container">
    <div class="sidebar">
        <div class="profile-section">
            <div class="profile-pic-container">
                <img id="profilePic" src="your-profile-pic.jpg" alt="Profile Picture">
                <div class="profile-pic-overlay">
                    <i class="fas fa-camera"></i>
                    <span>Change Photo</span>
                </div>
                <input type="file" id="fileInput" accept="image/*" hidden>
            </div>

            <button id="deletePicButton" class="delete-pic-btn" style="display:none;">
                <i class="fas fa-trash-alt"></i> Remove Photo
            </button>

            <div class="profile-info">
                <h2 contenteditable="true" id="artistName">
                    <i class="fas fa-user-edit"></i>
                    <span>Artist Name</span>
                </h2>
                <p contenteditable="true" id="artistDescription">
                    Welcome to your dashboard. Here you can manage your uploads and sold art.
                </p>
            </div>

            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <div class="main-content">
        <div class="your-art">
            <h2><i class="fas fa-palette"></i> Your Art</h2>
            <div class="art-container" id="artContainer">
                <!-- Dynamic Content -->
            </div>
        </div>
    </div>
</div>

<div id="editArtModal" class="modal" style="display:none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-edit"></i> Edit Art Details</h2>
            <span class="close"><i class="fas fa-times"></i></span>
        </div>
        <form id="editArtForm">
            <div class="form-group">
                <label for="editArtTitle"><i class="fas fa-heading"></i> Title</label>
                <input type="text" id="editArtTitle" required>
            </div>
            <div class="form-group">
                <label for="editArtDescription"><i class="fas fa-align-left"></i> Description</label>
                <textarea id="editArtDescription" required></textarea>
            </div>
            <div class="form-group">
                <label for="editArtPrice"><i class="fas fa-tag"></i> Price ($)</label>
                <input type="number" id="editArtPrice" required>
            </div>
            <button type="submit"><i class="fas fa-save"></i> Save Changes</button>
        </form>
    </div>
</div>

<script>
    const modal = document.getElementById('editArtModal');
    const closeBtn = modal.querySelector('.close');
    let currentEditingArtTitle = null;

    const fileInput = document.getElementById('fileInput');
    const deletePicButton = document.getElementById('deletePicButton');

    // Auth Check
    if (!localStorage.getItem('loggedIn')) {
        window.location.href = 'Logout.html';
    }

    function logout() {
        localStorage.removeItem('loggedIn');
        window.location.href = 'Logout.html';
    }

    function updateProfilePic(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = e => {
                document.getElementById('profilePic').src = e.target.result;
                localStorage.setItem('profilePic', e.target.result);
                deletePicButton.style.display = 'block';
            }
            reader.readAsDataURL(file);
        }
    }

    function deleteProfilePic() {
        document.getElementById('profilePic').src = 'your-profile-pic.jpg';
        localStorage.removeItem('profilePic');
        deletePicButton.style.display = 'none';
    }

    function openEditModal(artTitle) {
        const artCollection = JSON.parse(localStorage.getItem('artCollection')) || [];
        const art = artCollection.find(a => a.title === artTitle);
        if (!art) return;
        currentEditingArtTitle = art.title;
        document.getElementById('editArtTitle').value = art.title;
        document.getElementById('editArtDescription').value = art.description;
        document.getElementById('editArtPrice').value = art.price;
        modal.style.display = 'block';
    }

    function closeEditModal() {
        modal.style.display = 'none';
        currentEditingArtTitle = null;
    }

    function deleteArt(artTitle) {
        if (confirm('Are you sure you want to delete this artwork?')) {
            let artCollection = JSON.parse(localStorage.getItem('artCollection')) || [];
            artCollection = artCollection.filter(art => art.title !== artTitle);
            localStorage.setItem('artCollection', JSON.stringify(artCollection));
            location.reload();
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const storedPic = localStorage.getItem('profilePic');
        if (storedPic) {
            document.getElementById('profilePic').src = storedPic;
            deletePicButton.style.display = 'block';
        }

        document.getElementById('artistName').innerText = localStorage.getItem('artistName') || "Artist Name";
        document.getElementById('artistDescription').innerText = localStorage.getItem('artistDescription') || "Welcome to your dashboard. Here you can manage your uploads and sold art.";

        const artCollection = JSON.parse(localStorage.getItem('artCollection')) || [];
        const artContainer = document.getElementById('artContainer');

        if (!artCollection.length) {
            artContainer.innerHTML = "<p>No art available yet!</p>";
        } else {
            artCollection.forEach(art => {
                const artItem = document.createElement('div');
                artItem.classList.add('art-item');
                artItem.innerHTML = `
                    <div class="art-item-image-container">
                        <img src="${art.image}" alt="${art.title}" style="max-width:300px;">
                    </div>
                    <div class="art-item-details">
                        <h3>${art.title}</h3>
                        <p>${art.description}</p>
                        <p class="price">Price: $${art.price}</p>
                    </div>
                    <div class="art-actions">
                        <button class="action-btn edit-btn" onclick="openEditModal('${art.title.replace(/'/g, "\\'")}')">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteArt('${art.title.replace(/'/g, "\\'")}')">
                            <i class="fas fa-trash-alt"></i> Delete
                        </button>
                    </div>`;
                artContainer.appendChild(artItem);
            });
        }
    });

    document.getElementById('editArtForm').addEventListener('submit', e => {
        e.preventDefault();
        let artCollection = JSON.parse(localStorage.getItem('artCollection')) || [];
        artCollection = artCollection.map(art => {
            if (art.title === currentEditingArtTitle) {
                return {
                    ...art,
                    title: document.getElementById('editArtTitle').value,
                    description: document.getElementById('editArtDescription').value,
                    price: document.getElementById('editArtPrice').value,
                };
            }
            return art;
        });
        localStorage.setItem('artCollection', JSON.stringify(artCollection));
        closeEditModal();
        location.reload();
    });

    document.getElementById('artistName').addEventListener('blur', () => {
        localStorage.setItem('artistName', document.getElementById('artistName').innerText.trim());
    });

    document.getElementById('artistDescription').addEventListener('blur', () => {
        localStorage.setItem('artistDescription', document.getElementById('artistDescription').innerText.trim());
    });

    closeBtn.addEventListener('click', closeEditModal);
    window.addEventListener('click', e => { if (e.target == modal) closeEditModal() });
    window.addEventListener('keydown', e => { if (e.key === 'Escape') closeEditModal() });
    fileInput.addEventListener('change', updateProfilePic);
    deletePicButton.addEventListener('click', deleteProfilePic);
    document.querySelector('.profile-pic-overlay').addEventListener('click', () => fileInput.click());
</script>

</body>
</html>
